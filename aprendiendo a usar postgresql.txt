-------------------------------------
PARA CUANDO TENGA PORBLEMAS CON LOS CLUSTER
pg_lsclusters
sudo systemctl stop postgresql@11-main
sudo pg_dropcluster --stop 11 main
sudo pg_createcluster --start 11 main
---------------------------------------------
NOTA IMPORTANTISIMA: LOS ROLES LO UNICO QUE HACEN ES APUNTAR LOS PRIVILEGIOS QUE TENDRA EL USUARIO CREADO CON ESE MISMO NOMBRE, Y LAS BASES DE DATOS SON EL LUGAR DONDE LOS PRIVILEGIOS VAN A USARSE, ES POR ESTO EL ROLE, LA BASE DE DATOS Y EL USUARIO DEBEN LLAMARSE IGUAL.

sudo -i -u postgres = se usa para ingresar a la cuenta predeterminada de postgres

sudo -u postgres createuser --interactive = se usa para crear un rol nuevo

sudo -u postgres createdb <nombre del rol> = se usa para crear una base de datos en un rol

   pasos para abrir una linea de comandos de
   postgres con un rol distinto a postgres
   
1) sudo adduser <nombre del nuevo usuario> (se recomienda que el nombre de usuario sea el mismo del rol)

2) sudo -i -u <nombre del nuevo usuario>

3) psql (para abrir la linea de comandos del rol e en ese nuevo usuario)

psql -d <nombre del rol distinto> = para conectar a una base de datos diferente a la del nomber del usuario

sudo -u <nombre de usuario> psql <nombre del rol> = se usa para entrar a la linea de comandos directamente

sudo -u postgres dropbd <nombre del rol> = se usa para eliminar roles

sudo -u postgres pg_dump <nombre del rol> > <nombre del back up>.sql = se usa para hacer un backup de la base de datos(rol)

sudo -u postgres pg_dump -t <nombre de la tabla> <nombre del rol> > <nombre del archivo donde se guardara la tabla>.sql = se usa para hacer un backup de una lista

sudo service postgresql restart = reiniciar postgres

sudo passwd postgres = cambiar contrase√±a de usuario postgres 
pero es preferible hacerlo asi: 

1)sudo -u user_name psql db_name
2)ALTER USER user_name WITH PASSWORD 'new_password';

psql -U postgres -h <host> = para crear una sesion iteractiva con la base de datos 

\conninfo = con esto se visualiza la informacion de la conexion con la base de datos

pg_lsclusters = se usa para listar los cluster usados

pg_createcluster = este es el comando que se usa para cerar nuevos cluster en ubuntu, no initdb

pg_ctlcluster <version de postresql> <nombre del cluster> start = asi se inicia un cluster

\l = con esto se miran las bases de datos en el cluster

\du = con esto se listan los roles (usuarios) con sus atributos



---------CONSULTAS------------

DROP DATABASE IF EXISTS <database_name>; = esta consulta se usa para eliminar bases de datos

CREATE DATABASE <database_name>; = esta consulta se usa para crear bases de datos

SELECT datname FROM pg_database; = con esta consulta se listan las bases de datos

CREATE TABLE <nombre de la tabla> (<columna1> <tipo de dato columna1>, <columna2> <tipo de dato columna2>, ...); = asi se crean tablas

SELECT*FROM pg_catalog.pg_user; = con esta consulta se listan los roles en el cluster

CREATE ROLE = si se va a crear un rol con esta sentencia es mejor ver el siguiente link para saber que atributos ponerle https://www.postgresql.org/docs/9.1/sql-createrole.html

DROP TABLE <nombre de la tabla> =  asi se borran tablas

CREATE ROLE <nombre del rol> WITH LOGIN ENCRYPTED PASSWORD 'password1';

DROP ROLE <nombre del rol>; = asi se elimina un rol del cluster

INSERT INTO weather (city, temp_lo, temp_hi, prcp, date) VALUES ('San Francisco', 43, 57, 0.0, '1994-11-29'); = asi se rellenan las tablas, con esa sintaxis, primero se colocan los nombres de las columnas y luego se colocan los valores de cada columna

DELETE FROM <nombre de la tabla> WHERE <condicion que se cumple en la tabla>

SELECT * FROM <nombe de la tabla>; = esto se usa para ver el contenido de todas las columnas de una tabla

SELECT * FROM information_schema.tables; = \dt *.* = \dt <schema particular>.* = para ver todas las tablas

DROP DATABASE [IF EXISTS] database_name;

UPDATE <nombre de la tabla> SET <nombre de la columna>=<valor a cambiar en la columna> WHERE <nombre de la columna>=<valor actual en la columna>; = esto se usa para reescribir el valor de una fila en una tabla
